<!doctype html>
<html data-n-head-ssr lang="en" amp data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D,%22amp%22:%7B%22ssr%22:true%7D%7D">
  <head>
    <meta data-n-head="ssr" name="google-site-verification" content="Zl4VaEbx38uOgJQ-eJiMHGMevYjbzG2L2COfzfyRPcE"><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="robots" content="index,follow"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="og:type" property="og:type" content="website"><meta data-n-head="ssr" data-hid="og:site_name" property="og:site_name" content="Gioele Crispo"><meta data-n-head="ssr" data-hid="og:title" property="og:title" content="The importance of Semantics - Text Chunks of better quality"><meta data-n-head="ssr" data-hid="description" name="description" content="I have used several text chunkers based on token counting, but no one satisfied me... therefore I built my own one. Discover how I managed to have <b>better quality text chunks</b>!"><meta data-n-head="ssr" data-hid="og:description" name="og:description" content="I have used several text chunkers based on token counting, but no one satisfied me... therefore I built my own one. Discover how I managed to have <b>better quality text chunks</b>!"><meta data-n-head="ssr" data-hid="og:url" property="og:url" content="https://gioelecrispo.github.io/blog/the-importance-of-semantics-text-chunks-of-better-quality/"><meta data-n-head="ssr" data-hid="og:image" property="og:image" content="https://gioelecrispo.github.io/blog/the-importance-of-semantics-text-chunks-of-better-quality/_index.jpg"><meta data-n-head="ssr" data-hid="twitter:card" property="twitter:card" content="summary_large_image"><meta data-n-head="ssr" data-hid="twitter:title" property="twitter:title" content="The importance of Semantics - Text Chunks of better quality"><meta data-n-head="ssr" data-hid="twitter:description" name="twitter:description" content="I have used several text chunkers based on token counting, but no one satisfied me... therefore I built my own one. Discover how I managed to have <b>better quality text chunks</b>!"><meta data-n-head="ssr" data-hid="twitter:image" property="twitter:image" content="https://gioelecrispo.github.io/blog/the-importance-of-semantics-text-chunks-of-better-quality/_index.jpg"><meta data-n-head="ssr" data-hid="article:published_time" property="article:published_time" content="2023-07-11T11:11:20.000Z"><meta data-n-head="ssr" data-hid="article:modified_time" property="article:modified_time" content="2022-07-11T11:11:20.000Z"><meta data-n-head="ssr" data-hid="article:tag" property="article:tag" content="nlp,python,artificial-intelligence"><meta data-n-head="ssr" data-hid="twitter:label1" property="twitter:label1" content="Written by"><meta data-n-head="ssr" data-hid="twitter:data1" property="twitter:data1" content="Gioele Crispo"><meta data-n-head="ssr" data-hid="twitter:label2" property="twitter:label2" content="Filed under"><meta data-n-head="ssr" data-hid="twitter:data2" property="twitter:data2" content="nlp,python,artificial-intelligence"><title>The importance of Semantics - Text Chunks of better quality - Gioele Crispo</title><base href="/"><link data-n-head="ssr" rel="icon" type="image/png" href="/favicon.ico"><link data-n-head="ssr" data-hid="canonical" rel="canonical" href="https://gioelecrispo.github.io/blog/the-importance-of-semantics-text-chunks-of-better-quality/"><style data-n-head="vuetify" type="text/css" id="vuetify-theme-stylesheet" nonce="undefined">:root{--v-anchor-base:#2196f3;--v-primary-base:#2196f3;--v-primary-lighten5:#d4ffff;--v-primary-lighten4:#b5ffff;--v-primary-lighten3:#95e8ff;--v-primary-lighten2:#75ccff;--v-primary-lighten1:#51b0ff;--v-primary-darken1:#007cd6;--v-primary-darken2:#0064ba;--v-primary-darken3:#004d9f;--v-primary-darken4:#003784;--v-secondary-base:#e91e63;--v-secondary-lighten5:#ffc0e7;--v-secondary-lighten4:#ffa3cb;--v-secondary-lighten3:#ff85b0;--v-secondary-lighten2:#ff6795;--v-secondary-lighten1:#ff467c;--v-secondary-darken1:#c9004b;--v-secondary-darken2:#aa0035;--v-secondary-darken3:#8b0021;--v-secondary-darken4:#6c000a;--v-accent-base:#ffb510;--v-accent-lighten5:#ffffad;--v-accent-lighten4:#ffff90;--v-accent-lighten3:#ffff74;--v-accent-lighten2:#ffed57;--v-accent-lighten1:#ffd039;--v-accent-darken1:#df9a00;--v-accent-darken2:#c08000;--v-accent-darken3:#a26700;--v-accent-darken4:#854f00;--v-error-base:#ff5252;--v-error-lighten5:#ffe4d5;--v-error-lighten4:#ffc6b9;--v-error-lighten3:#ffa99e;--v-error-lighten2:#ff8c84;--v-error-lighten1:#ff6f6a;--v-error-darken1:#df323b;--v-error-darken2:#bf0025;--v-error-darken3:#9f0010;--v-error-darken4:#800000;--v-info-base:#2196f3;--v-info-lighten5:#d4ffff;--v-info-lighten4:#b5ffff;--v-info-lighten3:#95e8ff;--v-info-lighten2:#75ccff;--v-info-lighten1:#51b0ff;--v-info-darken1:#007cd6;--v-info-darken2:#0064ba;--v-info-darken3:#004d9f;--v-info-darken4:#003784;--v-success-base:#4caf50;--v-success-lighten5:#dcffd6;--v-success-lighten4:#beffba;--v-success-lighten3:#a2ff9e;--v-success-lighten2:#85e783;--v-success-lighten1:#69cb69;--v-success-darken1:#2d9437;--v-success-darken2:#00791e;--v-success-darken3:#006000;--v-success-darken4:#004700;--v-warning-base:#ffc107;--v-warning-lighten5:#ffffae;--v-warning-lighten4:#ffff91;--v-warning-lighten3:#ffff74;--v-warning-lighten2:#fff956;--v-warning-lighten1:#ffdd37;--v-warning-darken1:#e0a600;--v-warning-darken2:#c18c00;--v-warning-darken3:#a27300;--v-warning-darken4:#855a00;--v-sectionPrimary-base:#ffffff;--v-sectionPrimary-lighten5:#ffffff;--v-sectionPrimary-lighten4:#ffffff;--v-sectionPrimary-lighten3:#ffffff;--v-sectionPrimary-lighten2:#ffffff;--v-sectionPrimary-lighten1:#ffffff;--v-sectionPrimary-darken1:#e2e2e2;--v-sectionPrimary-darken2:#c6c6c6;--v-sectionPrimary-darken3:#ababab;--v-sectionPrimary-darken4:#919191;--v-sectionSecondary-base:#efefef;--v-sectionSecondary-lighten5:#ffffff;--v-sectionSecondary-lighten4:#ffffff;--v-sectionSecondary-lighten3:#ffffff;--v-sectionSecondary-lighten2:#ffffff;--v-sectionSecondary-lighten1:#ffffff;--v-sectionSecondary-darken1:#d3d3d3;--v-sectionSecondary-darken2:#b7b7b7;--v-sectionSecondary-darken3:#9c9c9c;--v-sectionSecondary-darken4:#828282}.v-application a{color:var(--v-anchor-base)}.v-application .primary{background-color:var(--v-primary-base)!important;border-color:var(--v-primary-base)!important}.v-application .primary--text{color:var(--v-primary-base)!important;caret-color:var(--v-primary-base)!important}.v-application .primary.lighten-5{background-color:var(--v-primary-lighten5)!important;border-color:var(--v-primary-lighten5)!important}.v-application .primary--text.text--lighten-5{color:var(--v-primary-lighten5)!important;caret-color:var(--v-primary-lighten5)!important}.v-application .primary.lighten-4{background-color:var(--v-primary-lighten4)!important;border-color:var(--v-primary-lighten4)!important}.v-application .primary--text.text--lighten-4{color:var(--v-primary-lighten4)!important;caret-color:var(--v-primary-lighten4)!important}.v-application .primary.lighten-3{background-color:var(--v-primary-lighten3)!important;border-color:var(--v-primary-lighten3)!important}.v-application .primary--text.text--lighten-3{color:var(--v-primary-lighten3)!important;caret-color:var(--v-primary-lighten3)!important}.v-application .primary.lighten-2{background-color:var(--v-primary-lighten2)!important;border-color:var(--v-primary-lighten2)!important}.v-application .primary--text.text--lighten-2{color:var(--v-primary-lighten2)!important;caret-color:var(--v-primary-lighten2)!important}.v-application .primary.lighten-1{background-color:var(--v-primary-lighten1)!important;border-color:var(--v-primary-lighten1)!important}.v-application .primary--text.text--lighten-1{color:var(--v-primary-lighten1)!important;caret-color:var(--v-primary-lighten1)!important}.v-application .primary.darken-1{background-color:var(--v-primary-darken1)!important;border-color:var(--v-primary-darken1)!important}.v-application .primary--text.text--darken-1{color:var(--v-primary-darken1)!important;caret-color:var(--v-primary-darken1)!important}.v-application .primary.darken-2{background-color:var(--v-primary-darken2)!important;border-color:var(--v-primary-darken2)!important}.v-application .primary--text.text--darken-2{color:var(--v-primary-darken2)!important;caret-color:var(--v-primary-darken2)!important}.v-application .primary.darken-3{background-color:var(--v-primary-darken3)!important;border-color:var(--v-primary-darken3)!important}.v-application .primary--text.text--darken-3{color:var(--v-primary-darken3)!important;caret-color:var(--v-primary-darken3)!important}.v-application .primary.darken-4{background-color:var(--v-primary-darken4)!important;border-color:var(--v-primary-darken4)!important}.v-application .primary--text.text--darken-4{color:var(--v-primary-darken4)!important;caret-color:var(--v-primary-darken4)!important}.v-application .secondary{background-color:var(--v-secondary-base)!important;border-color:var(--v-secondary-base)!important}.v-application .secondary--text{color:var(--v-secondary-base)!important;caret-color:var(--v-secondary-base)!important}.v-application .secondary.lighten-5{background-color:var(--v-secondary-lighten5)!important;border-color:var(--v-secondary-lighten5)!important}.v-application .secondary--text.text--lighten-5{color:var(--v-secondary-lighten5)!important;caret-color:var(--v-secondary-lighten5)!important}.v-application .secondary.lighten-4{background-color:var(--v-secondary-lighten4)!important;border-color:var(--v-secondary-lighten4)!important}.v-application .secondary--text.text--lighten-4{color:var(--v-secondary-lighten4)!important;caret-color:var(--v-secondary-lighten4)!important}.v-application .secondary.lighten-3{background-color:var(--v-secondary-lighten3)!important;border-color:var(--v-secondary-lighten3)!important}.v-application .secondary--text.text--lighten-3{color:var(--v-secondary-lighten3)!important;caret-color:var(--v-secondary-lighten3)!important}.v-application .secondary.lighten-2{background-color:var(--v-secondary-lighten2)!important;border-color:var(--v-secondary-lighten2)!important}.v-application .secondary--text.text--lighten-2{color:var(--v-secondary-lighten2)!important;caret-color:var(--v-secondary-lighten2)!important}.v-application .secondary.lighten-1{background-color:var(--v-secondary-lighten1)!important;border-color:var(--v-secondary-lighten1)!important}.v-application .secondary--text.text--lighten-1{color:var(--v-secondary-lighten1)!important;caret-color:var(--v-secondary-lighten1)!important}.v-application .secondary.darken-1{background-color:var(--v-secondary-darken1)!important;border-color:var(--v-secondary-darken1)!important}.v-application .secondary--text.text--darken-1{color:var(--v-secondary-darken1)!important;caret-color:var(--v-secondary-darken1)!important}.v-application .secondary.darken-2{background-color:var(--v-secondary-darken2)!important;border-color:var(--v-secondary-darken2)!important}.v-application .secondary--text.text--darken-2{color:var(--v-secondary-darken2)!important;caret-color:var(--v-secondary-darken2)!important}.v-application .secondary.darken-3{background-color:var(--v-secondary-darken3)!important;border-color:var(--v-secondary-darken3)!important}.v-application .secondary--text.text--darken-3{color:var(--v-secondary-darken3)!important;caret-color:var(--v-secondary-darken3)!important}.v-application .secondary.darken-4{background-color:var(--v-secondary-darken4)!important;border-color:var(--v-secondary-darken4)!important}.v-application .secondary--text.text--darken-4{color:var(--v-secondary-darken4)!important;caret-color:var(--v-secondary-darken4)!important}.v-application .accent{background-color:var(--v-accent-base)!important;border-color:var(--v-accent-base)!important}.v-application .accent--text{color:var(--v-accent-base)!important;caret-color:var(--v-accent-base)!important}.v-application .accent.lighten-5{background-color:var(--v-accent-lighten5)!important;border-color:var(--v-accent-lighten5)!important}.v-application .accent--text.text--lighten-5{color:var(--v-accent-lighten5)!important;caret-color:var(--v-accent-lighten5)!important}.v-application .accent.lighten-4{background-color:var(--v-accent-lighten4)!important;border-color:var(--v-accent-lighten4)!important}.v-application .accent--text.text--lighten-4{color:var(--v-accent-lighten4)!important;caret-color:var(--v-accent-lighten4)!important}.v-application .accent.lighten-3{background-color:var(--v-accent-lighten3)!important;border-color:var(--v-accent-lighten3)!important}.v-application .accent--text.text--lighten-3{color:var(--v-accent-lighten3)!important;caret-color:var(--v-accent-lighten3)!important}.v-application .accent.lighten-2{background-color:var(--v-accent-lighten2)!important;border-color:var(--v-accent-lighten2)!important}.v-application .accent--text.text--lighten-2{color:var(--v-accent-lighten2)!important;caret-color:var(--v-accent-lighten2)!important}.v-application .accent.lighten-1{background-color:var(--v-accent-lighten1)!important;border-color:var(--v-accent-lighten1)!important}.v-application .accent--text.text--lighten-1{color:var(--v-accent-lighten1)!important;caret-color:var(--v-accent-lighten1)!important}.v-application .accent.darken-1{background-color:var(--v-accent-darken1)!important;border-color:var(--v-accent-darken1)!important}.v-application .accent--text.text--darken-1{color:var(--v-accent-darken1)!important;caret-color:var(--v-accent-darken1)!important}.v-application .accent.darken-2{background-color:var(--v-accent-darken2)!important;border-color:var(--v-accent-darken2)!important}.v-application .accent--text.text--darken-2{color:var(--v-accent-darken2)!important;caret-color:var(--v-accent-darken2)!important}.v-application .accent.darken-3{background-color:var(--v-accent-darken3)!important;border-color:var(--v-accent-darken3)!important}.v-application .accent--text.text--darken-3{color:var(--v-accent-darken3)!important;caret-color:var(--v-accent-darken3)!important}.v-application .accent.darken-4{background-color:var(--v-accent-darken4)!important;border-color:var(--v-accent-darken4)!important}.v-application .accent--text.text--darken-4{color:var(--v-accent-darken4)!important;caret-color:var(--v-accent-darken4)!important}.v-application .error{background-color:var(--v-error-base)!important;border-color:var(--v-error-base)!important}.v-application .error--text{color:var(--v-error-base)!important;caret-color:var(--v-error-base)!important}.v-application .error.lighten-5{background-color:var(--v-error-lighten5)!important;border-color:var(--v-error-lighten5)!important}.v-application .error--text.text--lighten-5{color:var(--v-error-lighten5)!important;caret-color:var(--v-error-lighten5)!important}.v-application .error.lighten-4{background-color:var(--v-error-lighten4)!important;border-color:var(--v-error-lighten4)!important}.v-application .error--text.text--lighten-4{color:var(--v-error-lighten4)!important;caret-color:var(--v-error-lighten4)!important}.v-application .error.lighten-3{background-color:var(--v-error-lighten3)!important;border-color:var(--v-error-lighten3)!important}.v-application .error--text.text--lighten-3{color:var(--v-error-lighten3)!important;caret-color:var(--v-error-lighten3)!important}.v-application .error.lighten-2{background-color:var(--v-error-lighten2)!important;border-color:var(--v-error-lighten2)!important}.v-application .error--text.text--lighten-2{color:var(--v-error-lighten2)!important;caret-color:var(--v-error-lighten2)!important}.v-application .error.lighten-1{background-color:var(--v-error-lighten1)!important;border-color:var(--v-error-lighten1)!important}.v-application .error--text.text--lighten-1{color:var(--v-error-lighten1)!important;caret-color:var(--v-error-lighten1)!important}.v-application .error.darken-1{background-color:var(--v-error-darken1)!important;border-color:var(--v-error-darken1)!important}.v-application .error--text.text--darken-1{color:var(--v-error-darken1)!important;caret-color:var(--v-error-darken1)!important}.v-application .error.darken-2{background-color:var(--v-error-darken2)!important;border-color:var(--v-error-darken2)!important}.v-application .error--text.text--darken-2{color:var(--v-error-darken2)!important;caret-color:var(--v-error-darken2)!important}.v-application .error.darken-3{background-color:var(--v-error-darken3)!important;border-color:var(--v-error-darken3)!important}.v-application .error--text.text--darken-3{color:var(--v-error-darken3)!important;caret-color:var(--v-error-darken3)!important}.v-application .error.darken-4{background-color:var(--v-error-darken4)!important;border-color:var(--v-error-darken4)!important}.v-application .error--text.text--darken-4{color:var(--v-error-darken4)!important;caret-color:var(--v-error-darken4)!important}.v-application .info{background-color:var(--v-info-base)!important;border-color:var(--v-info-base)!important}.v-application .info--text{color:var(--v-info-base)!important;caret-color:var(--v-info-base)!important}.v-application .info.lighten-5{background-color:var(--v-info-lighten5)!important;border-color:var(--v-info-lighten5)!important}.v-application .info--text.text--lighten-5{color:var(--v-info-lighten5)!important;caret-color:var(--v-info-lighten5)!important}.v-application .info.lighten-4{background-color:var(--v-info-lighten4)!important;border-color:var(--v-info-lighten4)!important}.v-application .info--text.text--lighten-4{color:var(--v-info-lighten4)!important;caret-color:var(--v-info-lighten4)!important}.v-application .info.lighten-3{background-color:var(--v-info-lighten3)!important;border-color:var(--v-info-lighten3)!important}.v-application .info--text.text--lighten-3{color:var(--v-info-lighten3)!important;caret-color:var(--v-info-lighten3)!important}.v-application .info.lighten-2{background-color:var(--v-info-lighten2)!important;border-color:var(--v-info-lighten2)!important}.v-application .info--text.text--lighten-2{color:var(--v-info-lighten2)!important;caret-color:var(--v-info-lighten2)!important}.v-application .info.lighten-1{background-color:var(--v-info-lighten1)!important;border-color:var(--v-info-lighten1)!important}.v-application .info--text.text--lighten-1{color:var(--v-info-lighten1)!important;caret-color:var(--v-info-lighten1)!important}.v-application .info.darken-1{background-color:var(--v-info-darken1)!important;border-color:var(--v-info-darken1)!important}.v-application .info--text.text--darken-1{color:var(--v-info-darken1)!important;caret-color:var(--v-info-darken1)!important}.v-application .info.darken-2{background-color:var(--v-info-darken2)!important;border-color:var(--v-info-darken2)!important}.v-application .info--text.text--darken-2{color:var(--v-info-darken2)!important;caret-color:var(--v-info-darken2)!important}.v-application .info.darken-3{background-color:var(--v-info-darken3)!important;border-color:var(--v-info-darken3)!important}.v-application .info--text.text--darken-3{color:var(--v-info-darken3)!important;caret-color:var(--v-info-darken3)!important}.v-application .info.darken-4{background-color:var(--v-info-darken4)!important;border-color:var(--v-info-darken4)!important}.v-application .info--text.text--darken-4{color:var(--v-info-darken4)!important;caret-color:var(--v-info-darken4)!important}.v-application .success{background-color:var(--v-success-base)!important;border-color:var(--v-success-base)!important}.v-application .success--text{color:var(--v-success-base)!important;caret-color:var(--v-success-base)!important}.v-application .success.lighten-5{background-color:var(--v-success-lighten5)!important;border-color:var(--v-success-lighten5)!important}.v-application .success--text.text--lighten-5{color:var(--v-success-lighten5)!important;caret-color:var(--v-success-lighten5)!important}.v-application .success.lighten-4{background-color:var(--v-success-lighten4)!important;border-color:var(--v-success-lighten4)!important}.v-application .success--text.text--lighten-4{color:var(--v-success-lighten4)!important;caret-color:var(--v-success-lighten4)!important}.v-application .success.lighten-3{background-color:var(--v-success-lighten3)!important;border-color:var(--v-success-lighten3)!important}.v-application .success--text.text--lighten-3{color:var(--v-success-lighten3)!important;caret-color:var(--v-success-lighten3)!important}.v-application .success.lighten-2{background-color:var(--v-success-lighten2)!important;border-color:var(--v-success-lighten2)!important}.v-application .success--text.text--lighten-2{color:var(--v-success-lighten2)!important;caret-color:var(--v-success-lighten2)!important}.v-application .success.lighten-1{background-color:var(--v-success-lighten1)!important;border-color:var(--v-success-lighten1)!important}.v-application .success--text.text--lighten-1{color:var(--v-success-lighten1)!important;caret-color:var(--v-success-lighten1)!important}.v-application .success.darken-1{background-color:var(--v-success-darken1)!important;border-color:var(--v-success-darken1)!important}.v-application .success--text.text--darken-1{color:var(--v-success-darken1)!important;caret-color:var(--v-success-darken1)!important}.v-application .success.darken-2{background-color:var(--v-success-darken2)!important;border-color:var(--v-success-darken2)!important}.v-application .success--text.text--darken-2{color:var(--v-success-darken2)!important;caret-color:var(--v-success-darken2)!important}.v-application .success.darken-3{background-color:var(--v-success-darken3)!important;border-color:var(--v-success-darken3)!important}.v-application .success--text.text--darken-3{color:var(--v-success-darken3)!important;caret-color:var(--v-success-darken3)!important}.v-application .success.darken-4{background-color:var(--v-success-darken4)!important;border-color:var(--v-success-darken4)!important}.v-application .success--text.text--darken-4{color:var(--v-success-darken4)!important;caret-color:var(--v-success-darken4)!important}.v-application .warning{background-color:var(--v-warning-base)!important;border-color:var(--v-warning-base)!important}.v-application .warning--text{color:var(--v-warning-base)!important;caret-color:var(--v-warning-base)!important}.v-application .warning.lighten-5{background-color:var(--v-warning-lighten5)!important;border-color:var(--v-warning-lighten5)!important}.v-application .warning--text.text--lighten-5{color:var(--v-warning-lighten5)!important;caret-color:var(--v-warning-lighten5)!important}.v-application .warning.lighten-4{background-color:var(--v-warning-lighten4)!important;border-color:var(--v-warning-lighten4)!important}.v-application .warning--text.text--lighten-4{color:var(--v-warning-lighten4)!important;caret-color:var(--v-warning-lighten4)!important}.v-application .warning.lighten-3{background-color:var(--v-warning-lighten3)!important;border-color:var(--v-warning-lighten3)!important}.v-application .warning--text.text--lighten-3{color:var(--v-warning-lighten3)!important;caret-color:var(--v-warning-lighten3)!important}.v-application .warning.lighten-2{background-color:var(--v-warning-lighten2)!important;border-color:var(--v-warning-lighten2)!important}.v-application .warning--text.text--lighten-2{color:var(--v-warning-lighten2)!important;caret-color:var(--v-warning-lighten2)!important}.v-application .warning.lighten-1{background-color:var(--v-warning-lighten1)!important;border-color:var(--v-warning-lighten1)!important}.v-application .warning--text.text--lighten-1{color:var(--v-warning-lighten1)!important;caret-color:var(--v-warning-lighten1)!important}.v-application .warning.darken-1{background-color:var(--v-warning-darken1)!important;border-color:var(--v-warning-darken1)!important}.v-application .warning--text.text--darken-1{color:var(--v-warning-darken1)!important;caret-color:var(--v-warning-darken1)!important}.v-application .warning.darken-2{background-color:var(--v-warning-darken2)!important;border-color:var(--v-warning-darken2)!important}.v-application .warning--text.text--darken-2{color:var(--v-warning-darken2)!important;caret-color:var(--v-warning-darken2)!important}.v-application .warning.darken-3{background-color:var(--v-warning-darken3)!important;border-color:var(--v-warning-darken3)!important}.v-application .warning--text.text--darken-3{color:var(--v-warning-darken3)!important;caret-color:var(--v-warning-darken3)!important}.v-application .warning.darken-4{background-color:var(--v-warning-darken4)!important;border-color:var(--v-warning-darken4)!important}.v-application .warning--text.text--darken-4{color:var(--v-warning-darken4)!important;caret-color:var(--v-warning-darken4)!important}.v-application .sectionPrimary{background-color:var(--v-sectionPrimary-base)!important;border-color:var(--v-sectionPrimary-base)!important}.v-application .sectionPrimary--text{color:var(--v-sectionPrimary-base)!important;caret-color:var(--v-sectionPrimary-base)!important}.v-application .sectionPrimary.lighten-5{background-color:var(--v-sectionPrimary-lighten5)!important;border-color:var(--v-sectionPrimary-lighten5)!important}.v-application .sectionPrimary--text.text--lighten-5{color:var(--v-sectionPrimary-lighten5)!important;caret-color:var(--v-sectionPrimary-lighten5)!important}.v-application .sectionPrimary.lighten-4{background-color:var(--v-sectionPrimary-lighten4)!important;border-color:var(--v-sectionPrimary-lighten4)!important}.v-application .sectionPrimary--text.text--lighten-4{color:var(--v-sectionPrimary-lighten4)!important;caret-color:var(--v-sectionPrimary-lighten4)!important}.v-application .sectionPrimary.lighten-3{background-color:var(--v-sectionPrimary-lighten3)!important;border-color:var(--v-sectionPrimary-lighten3)!important}.v-application .sectionPrimary--text.text--lighten-3{color:var(--v-sectionPrimary-lighten3)!important;caret-color:var(--v-sectionPrimary-lighten3)!important}.v-application .sectionPrimary.lighten-2{background-color:var(--v-sectionPrimary-lighten2)!important;border-color:var(--v-sectionPrimary-lighten2)!important}.v-application .sectionPrimary--text.text--lighten-2{color:var(--v-sectionPrimary-lighten2)!important;caret-color:var(--v-sectionPrimary-lighten2)!important}.v-application .sectionPrimary.lighten-1{background-color:var(--v-sectionPrimary-lighten1)!important;border-color:var(--v-sectionPrimary-lighten1)!important}.v-application .sectionPrimary--text.text--lighten-1{color:var(--v-sectionPrimary-lighten1)!important;caret-color:var(--v-sectionPrimary-lighten1)!important}.v-application .sectionPrimary.darken-1{background-color:var(--v-sectionPrimary-darken1)!important;border-color:var(--v-sectionPrimary-darken1)!important}.v-application .sectionPrimary--text.text--darken-1{color:var(--v-sectionPrimary-darken1)!important;caret-color:var(--v-sectionPrimary-darken1)!important}.v-application .sectionPrimary.darken-2{background-color:var(--v-sectionPrimary-darken2)!important;border-color:var(--v-sectionPrimary-darken2)!important}.v-application .sectionPrimary--text.text--darken-2{color:var(--v-sectionPrimary-darken2)!important;caret-color:var(--v-sectionPrimary-darken2)!important}.v-application .sectionPrimary.darken-3{background-color:var(--v-sectionPrimary-darken3)!important;border-color:var(--v-sectionPrimary-darken3)!important}.v-application .sectionPrimary--text.text--darken-3{color:var(--v-sectionPrimary-darken3)!important;caret-color:var(--v-sectionPrimary-darken3)!important}.v-application .sectionPrimary.darken-4{background-color:var(--v-sectionPrimary-darken4)!important;border-color:var(--v-sectionPrimary-darken4)!important}.v-application .sectionPrimary--text.text--darken-4{color:var(--v-sectionPrimary-darken4)!important;caret-color:var(--v-sectionPrimary-darken4)!important}.v-application .sectionSecondary{background-color:var(--v-sectionSecondary-base)!important;border-color:var(--v-sectionSecondary-base)!important}.v-application .sectionSecondary--text{color:var(--v-sectionSecondary-base)!important;caret-color:var(--v-sectionSecondary-base)!important}.v-application .sectionSecondary.lighten-5{background-color:var(--v-sectionSecondary-lighten5)!important;border-color:var(--v-sectionSecondary-lighten5)!important}.v-application .sectionSecondary--text.text--lighten-5{color:var(--v-sectionSecondary-lighten5)!important;caret-color:var(--v-sectionSecondary-lighten5)!important}.v-application .sectionSecondary.lighten-4{background-color:var(--v-sectionSecondary-lighten4)!important;border-color:var(--v-sectionSecondary-lighten4)!important}.v-application .sectionSecondary--text.text--lighten-4{color:var(--v-sectionSecondary-lighten4)!important;caret-color:var(--v-sectionSecondary-lighten4)!important}.v-application .sectionSecondary.lighten-3{background-color:var(--v-sectionSecondary-lighten3)!important;border-color:var(--v-sectionSecondary-lighten3)!important}.v-application .sectionSecondary--text.text--lighten-3{color:var(--v-sectionSecondary-lighten3)!important;caret-color:var(--v-sectionSecondary-lighten3)!important}.v-application .sectionSecondary.lighten-2{background-color:var(--v-sectionSecondary-lighten2)!important;border-color:var(--v-sectionSecondary-lighten2)!important}.v-application .sectionSecondary--text.text--lighten-2{color:var(--v-sectionSecondary-lighten2)!important;caret-color:var(--v-sectionSecondary-lighten2)!important}.v-application .sectionSecondary.lighten-1{background-color:var(--v-sectionSecondary-lighten1)!important;border-color:var(--v-sectionSecondary-lighten1)!important}.v-application .sectionSecondary--text.text--lighten-1{color:var(--v-sectionSecondary-lighten1)!important;caret-color:var(--v-sectionSecondary-lighten1)!important}.v-application .sectionSecondary.darken-1{background-color:var(--v-sectionSecondary-darken1)!important;border-color:var(--v-sectionSecondary-darken1)!important}.v-application .sectionSecondary--text.text--darken-1{color:var(--v-sectionSecondary-darken1)!important;caret-color:var(--v-sectionSecondary-darken1)!important}.v-application .sectionSecondary.darken-2{background-color:var(--v-sectionSecondary-darken2)!important;border-color:var(--v-sectionSecondary-darken2)!important}.v-application .sectionSecondary--text.text--darken-2{color:var(--v-sectionSecondary-darken2)!important;caret-color:var(--v-sectionSecondary-darken2)!important}.v-application .sectionSecondary.darken-3{background-color:var(--v-sectionSecondary-darken3)!important;border-color:var(--v-sectionSecondary-darken3)!important}.v-application .sectionSecondary--text.text--darken-3{color:var(--v-sectionSecondary-darken3)!important;caret-color:var(--v-sectionSecondary-darken3)!important}.v-application .sectionSecondary.darken-4{background-color:var(--v-sectionSecondary-darken4)!important;border-color:var(--v-sectionSecondary-darken4)!important}.v-application .sectionSecondary--text.text--darken-4{color:var(--v-sectionSecondary-darken4)!important;caret-color:var(--v-sectionSecondary-darken4)!important}</style><link rel="preload" href="/_nuxt/aa5daba.js" as="script"><link rel="preload" href="/_nuxt/01c6dd1.js" as="script"><link rel="preload" href="/_nuxt/css/3df5bc2.css" as="style"><link rel="preload" href="/_nuxt/9291ae6.js" as="script"><link rel="preload" href="/_nuxt/css/e207dc1.css" as="style"><link rel="preload" href="/_nuxt/44fd46b.js" as="script"><link rel="preload" href="/_nuxt/fbbfe42.js" as="script"><link rel="stylesheet" href="/_nuxt/css/3df5bc2.css"><link rel="stylesheet" href="/_nuxt/css/e207dc1.css"><link rel="preload" href="/_nuxt/static/1704239394/blog/the-importance-of-semantics-text-chunks-of-better-quality/state.js" as="script"><link rel="preload" href="/_nuxt/static/1704239394/blog/the-importance-of-semantics-text-chunks-of-better-quality/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1704239394/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div data-app="true" id="app-post" class="v-application v-application--is-ltr theme--light" data-v-000c4056><div class="v-application--wrap"><nav class="v-navigation-drawer v-navigation-drawer--close v-navigation-drawer--fixed v-navigation-drawer--is-mobile theme--light" style="height:100vh;top:0;transform:translateX(-100%);width:100%" data-v-5fc5aa13 data-v-000c4056><div class="v-navigation-drawer__content"><div class="container container--fluid" data-v-5fc5aa13><div class="row mr-3 justify-end" data-v-5fc5aa13><button type="button" class="v-btn v-btn--icon v-btn--round theme--light v-size--default" data-v-5fc5aa13><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-close theme--light" data-v-5fc5aa13></i></span></button></div> <div class="row" data-v-5fc5aa13><div class="col-sm-6 col-12" data-v-5fc5aa13><div class="container container--fluid fill-height" data-v-5fc5aa13><div class="row pt-6 align-center justify-center" data-v-5fc5aa13><div class="v-avatar outline-border" style="height:144px;min-width:144px;width:144px" data-v-3d5db6c9 data-v-5fc5aa13><img src="/_nuxt/img/9d8aa01.jpg" alt="avatar" data-v-3d5db6c9></div></div></div></div> <div class="col-sm-6 col-12" data-v-5fc5aa13><div class="v-list pt-6 mt-0 v-sheet theme--light rounded v-list--dense v-list--rounded" data-v-5fc5aa13><div role="listbox" class="v-item-group theme--light v-list-item-group" data-v-5fc5aa13><a href="/" tabindex="0" class="text-center primary--text v-list-item v-list-item--link theme--light" data-v-5fc5aa13><div class="row" data-v-5fc5aa13><div class="col col-12" data-v-5fc5aa13><div class="row justify-center" data-v-5fc5aa13><i aria-hidden="true" class="v-icon notranslate mr-4 primary--text mdi mdi-home theme--light" data-v-5fc5aa13></i>
                                        Home
                                    </div></div></div></a><a href="/resume" tabindex="0" class="text-center primary--text v-list-item v-list-item--link theme--light" data-v-5fc5aa13><div class="row" data-v-5fc5aa13><div class="col col-12" data-v-5fc5aa13><div class="row justify-center" data-v-5fc5aa13><i aria-hidden="true" class="v-icon notranslate mr-4 primary--text mdi mdi-timeline-text theme--light" data-v-5fc5aa13></i>
                                        Resume
                                    </div></div></div></a><a href="/projects" tabindex="0" class="text-center primary--text v-list-item v-list-item--link theme--light" data-v-5fc5aa13><div class="row" data-v-5fc5aa13><div class="col col-12" data-v-5fc5aa13><div class="row justify-center" data-v-5fc5aa13><i aria-hidden="true" class="v-icon notranslate mr-4 primary--text mdi mdi-briefcase-outline theme--light" data-v-5fc5aa13></i>
                                        Projects
                                    </div></div></div></a><a href="/github" tabindex="0" class="text-center primary--text v-list-item v-list-item--link theme--light" data-v-5fc5aa13><div class="row" data-v-5fc5aa13><div class="col col-12" data-v-5fc5aa13><div class="row justify-center" data-v-5fc5aa13><i aria-hidden="true" class="v-icon notranslate mr-4 primary--text mdi mdi-github theme--light" data-v-5fc5aa13></i>
                                        Github
                                    </div></div></div></a><a href="/blog" aria-current="page" tabindex="0" class="text-center primary--text v-item--active v-list-item--active v-list-item v-list-item--link theme--light" data-v-5fc5aa13><div class="row" data-v-5fc5aa13><div class="col col-12" data-v-5fc5aa13><div class="row justify-center" data-v-5fc5aa13><i aria-hidden="true" class="v-icon notranslate mr-4 primary--text mdi mdi-file-document-outline theme--light" data-v-5fc5aa13></i>
                                        Blog
                                    </div></div></div></a><a href="/books/discover-chatgpt-by-asking-it" tabindex="0" class="text-center primary--text v-list-item v-list-item--link theme--light" data-v-5fc5aa13><div class="row" data-v-5fc5aa13><div class="col col-12" data-v-5fc5aa13><div class="row justify-center" data-v-5fc5aa13><i aria-hidden="true" class="v-icon notranslate mr-4 primary--text mdi mdi-book theme--light" data-v-5fc5aa13></i>
                                        Book
                                    </div></div></div></a></div></div></div></div></div></div><div class="v-navigation-drawer__border"></div></nav> <header id="app-toolbar" class="v-sheet theme--dark v-toolbar v-toolbar--prominent v-app-bar v-app-bar--fade-img-on-scroll v-app-bar--elevate-on-scroll v-app-bar--fixed v-app-bar--hide-shadow v-app-bar--shrink-on-scroll primary" style="height:450px;font-size:1.5rem;margin-top:0;transform:translateY(0);left:0;right:0" data-v-a1e6582c data-v-000c4056><div class="v-toolbar__image" style="opacity:1"><div class="v-image v-responsive theme--dark" style="height:450px" data-v-a1e6582c><div class="v-image__image v-image__image--preload v-image__image--cover" style="background-image:linear-gradient(to top right,rgba(33,150,243,.9),rgba(33,150,243,.6));background-position:center center"></div><div class="v-responsive__content"></div></div></div><div class="v-toolbar__content" style="height:450px"> <button type="button" class="v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-a1e6582c><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-menu theme--dark" data-v-a1e6582c></i></span></button> <div class="v-toolbar__title pl-1 pr-3" data-v-a1e6582c><h3 data-v-a1e6582c>Post</h3></div> <div class="spacer" data-v-a1e6582c></div> <div class="row align-center justify-end" data-v-a1e6582c><!----> <button type="button" class="v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-a1e6582c><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate far fa-moon theme--dark" data-v-a1e6582c></i></span></button> <!----><!----><!----><!----><!----><!----></div></div></header> <main class="v-main" style="padding-top:450px;padding-right:0;padding-bottom:0;padding-left:0" data-v-000c4056><div class="v-main__wrap"><div class="container container--fluid" data-v-7185e49c data-v-7185e49c data-v-8ad15b1a data-v-8ad15b1a data-v-000c4056><div class="container" data-v-7185e49c data-v-7185e49c><div class="row mt-8 justify-center" data-v-7185e49c data-v-7185e49c><div class="col-lg-10 col-xl-9 col" data-v-7185e49c data-v-7185e49c><div class="pa-0 py-2 mb-8 v-card v-sheet theme--light elevation-0 transparent" style="height:30px" data-v-7185e49c><div class="v-card__title px-0 py-0 primary--text" data-v-7185e49c>#nlp, #python, #artificial-intelligence
                    </div> <div class="v-card__text px-0 py-0 grey--text" data-v-7185e49c>Written on: July 11, 2023
                    </div> <div class="v-card__text px-0 py-0 grey--text" data-v-7185e49c>Latest update: July 11, 2022
                    </div></div> <article class="pt-12" data-v-7185e49c><div class="nuxt-content" data-v-7185e49c data-v-7185e49c><h1 id="the-importance-of-semantics-text-chunks-of-better-quality" data-v-7185e49c data-v-7185e49c><a href="#the-importance-of-semantics-text-chunks-of-better-quality" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>The importance of Semantics: Text Chunks of better quality</h1>
<br data-v-7185e49c data-v-7185e49c>
<ul data-v-7185e49c data-v-7185e49c>
<li data-v-7185e49c data-v-7185e49c>Introduction</li>
<li data-v-7185e49c data-v-7185e49c>What is Chunking</li>
<li data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Chunkipy</strong>: library and algorithm description</li>
<li data-v-7185e49c data-v-7185e49c>Comparison with other libraries</li>
<li data-v-7185e49c data-v-7185e49c>Conclusions</li>
</ul>
<br data-v-7185e49c data-v-7185e49c>
<h2 id="introduction" data-v-7185e49c data-v-7185e49c><a href="#introduction" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Introduction</h2>
<p data-v-7185e49c data-v-7185e49c>In the realm of natural language processing, quite often there is the need to break down text into smaller,
more manageable pieces. This becomes particularly crucial when dealing with lengthy documents.
In fact, neural networks typically have an <strong data-v-7185e49c data-v-7185e49c>input size limit defined by the number of tokens</strong>.
Clearly, better the quality of the text, better the results.
This becomes even more critical when working with less powerful networks like BERT, which lack the ability of error
correction and sentence reconstruction seen in more complex models like ChatGPT.</p>
<p data-v-7185e49c data-v-7185e49c>Given this, rather than relying on token-based chunkers that merely divide at a predetermined token count,
without consideration for semantic coherence, I tried to follow a different approach, designing my own algorithm.
The idea of developing a new personalized chunking algorithm came out from the difficulty of finding
the definitive algorithm which could meet all my needs.
Therefore, after writing it and verifying its validity, I decided to build a library, thinking that it could be useful to other people.</p>
<p data-v-7185e49c data-v-7185e49c>It leverages sentence segmentation models to construct
text chunks with enhanced semantic meaning, ensuring readability and understanding.</p>
<p data-v-7185e49c data-v-7185e49c>I have the pleasure to introduce you <code data-v-7185e49c data-v-7185e49c>chunkipy</code>! Here you can find its:</p>
<ul data-v-7185e49c data-v-7185e49c>
<li data-v-7185e49c data-v-7185e49c><a href="https://pypi.org/project/chunkipy/" rel="nofollow noopener noreferrer" target="_blank" data-v-7185e49c data-v-7185e49c>Pip page</a></li>
<li data-v-7185e49c data-v-7185e49c><a href="https://github.com/gioelecrispo/chunkipy" rel="nofollow noopener noreferrer" target="_blank" data-v-7185e49c data-v-7185e49c>Github repository</a></li>
</ul>
<br data-v-7185e49c data-v-7185e49c>
<p data-v-7185e49c data-v-7185e49c>Before to dive deep into the algorithm description, let's briefly introduce what chunking means.</p>
<h2 id="what-is-chunking" data-v-7185e49c data-v-7185e49c><a href="#what-is-chunking" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>What is Chunking</h2>
<p data-v-7185e49c data-v-7185e49c>Chunking is the process of <strong data-v-7185e49c data-v-7185e49c>breaking down a piece of text into smaller pieces</strong>.</p>
<p data-v-7185e49c data-v-7185e49c>It is truly an easy concept, but with main implications for the downstream task one will apply later.</p>
<p data-v-7185e49c data-v-7185e49c>Lots of different techniques and approaches exist, for example:</p>
<ul data-v-7185e49c data-v-7185e49c>
<li data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>token-based chunkers</strong>, that divide at a predetermined token count;</li>
<li data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>separator-based or pattern-based chunkers</strong>, that divide when a separator is found or pattern is verified;</li>
<li data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>semantic-based chunkers</strong>, that use neural networks to determine how and when to divide the text;</li>
<li data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>hybrid chunkers</strong>, that combine some or all of these techniques to get the best result.</li>
</ul>
<br data-v-7185e49c data-v-7185e49c> 
Naturally, the techniques that rely on neural networks are slower compared to the separator/pattern ones; for this reason, 
it is convenient to mix the strategies and get the best result possible.
<p data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>chunkipy</code> belongs to the latest category, using a neural network and some heuristic to preserve the semantic integrity of the content.</p>
<h3 id="chunking-main-applications" data-v-7185e49c data-v-7185e49c><a href="#chunking-main-applications" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Chunking: main applications</h3>
<p data-v-7185e49c data-v-7185e49c>The importance of chunking becomes evident when considering its myriad applications. Let me introduce the two most relevant ones:</p>
<h4 id="vector-search" data-v-7185e49c data-v-7185e49c><a href="#vector-search" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Vector Search</h4>
<p data-v-7185e49c data-v-7185e49c>One such application is <strong data-v-7185e49c data-v-7185e49c>Vector Search</strong>. By dividing text into chunks with coherent meanings, vector search
engines can more effectively match user queries with relevant content.
This not only enhances the accuracy of search results but also improves user experience. In fact, when a chunk is retrieved after a search,
the user can enjoy the reading of that piece of text without falling into incomplete sentences which could undermine the meaning.</p>
<p data-v-7185e49c data-v-7185e49c>Furthermore, vector search benefits greatly from well-defined text chunks.
Document representations constructed from these semantically meaningful segments can capture the essence of the content more accurately.
This leads to improved clustering and similarity measures, enhancing the quality of information retrieval.</p>
<h4 id="named-entity-recognition" data-v-7185e49c data-v-7185e49c><a href="#named-entity-recognition" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Named Entity Recognition</h4>
<p data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Named Entity Recognition</strong> (NER) is a critical task in natural language processing that involves identifying and classifying named entities
within a body of text. These entities can be anything from names of people, organizations, locations, dates, quantities, and more.
NER has gained immense importance in today's information-driven world.</p>
<p data-v-7185e49c data-v-7185e49c>With the proliferation of digital content across social media, news articles, research papers, and more, extracting
structured information from unstructured text has become indispensable. NER enables automated systems to analyze and
categorize vast amounts of data, facilitating information retrieval, knowledge extraction, and decision-making processes in various fields.</p>
<p data-v-7185e49c data-v-7185e49c>Therefore, <strong data-v-7185e49c data-v-7185e49c>chunking plays a pivotal role in NER</strong> and is fundamental for its accuracy and efficiency.</p>
<p data-v-7185e49c data-v-7185e49c>In fact, chunking assists NER by breaking down text into smaller, meaningful segments.
When identifying named entities, it's crucial to consider the context in which these entities appear.
By chunking text effectively, NER models can focus on smaller sections, thus improving their ability to recognize and
classify named entities accurately within that specific context.
<br data-v-7185e49c data-v-7185e49c></p>
<h2 id="chunkipy-library-and-algorithm-description" data-v-7185e49c data-v-7185e49c><a href="#chunkipy-library-and-algorithm-description" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Chunkipy: library and algorithm description</h2>
<p data-v-7185e49c data-v-7185e49c>The library offers some useful features:</p>
<ul data-v-7185e49c data-v-7185e49c>
<li data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Token estimation</strong>: unlike many text chunking libraries, <code data-v-7185e49c data-v-7185e49c>chunkipy</code> offers the possibility of
providing a token estimator function, in order to build the chunks taking into account the tokenizer
that will use those chunks.</li>
<li data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Split text into meaningful sentences</strong>: in its default configuration, <code data-v-7185e49c data-v-7185e49c>chunkipy</code>,
in creating the chunks, avoids cutting sentences, and always tries to have a complete and syntactically correct sentence.
This is achieved through the use of the <code data-v-7185e49c data-v-7185e49c>stanza</code> library, which utilizes semantic models to cut text
into meaningful sentences.</li>
<li data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Smart Overlapping</strong>: <code data-v-7185e49c data-v-7185e49c>chunkipy</code> offers the possibility to define an <code data-v-7185e49c data-v-7185e49c>overlap_percentage</code> and create overlapping chunks to
preserve the context along chunks. The overlap also preserve sentences.</li>
<li data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Flexibility in choosing split strategies</strong>: Additionally, <code data-v-7185e49c data-v-7185e49c>chunkipy</code> offers complete flexibility
in choosing how to split, allowing users to define their own text splitting function or choose from a list
of pre-defined splitting strategies. I will deepen this point later.</li>
</ul>
<br data-v-7185e49c data-v-7185e49c>
<h3 id="installation-and-usage" data-v-7185e49c data-v-7185e49c><a href="#installation-and-usage" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Installation and Usage</h3>
<p data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>chunkipy</code> can be installed through pip with the following command:</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-bash" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>pip <span class="token function" data-v-7185e49c data-v-7185e49c>install</span> chunkipy
</code></pre></div>
<p data-v-7185e49c data-v-7185e49c>The main class in <code data-v-7185e49c data-v-7185e49c>chunkipy</code> is <code data-v-7185e49c data-v-7185e49c>TextChunker</code>. You can use the default settings or specify custom parameters for the <strong data-v-7185e49c data-v-7185e49c>chunk size</strong>,
whether to split by <strong data-v-7185e49c data-v-7185e49c>characters or tokens</strong>, <strong data-v-7185e49c data-v-7185e49c>overlap_percent</strong> to define the overlapping percentage,
the <strong data-v-7185e49c data-v-7185e49c>tokenizer function</strong> to use (if <code data-v-7185e49c data-v-7185e49c>tokens</code> is set to <code data-v-7185e49c data-v-7185e49c>True</code>), and the list of <strong data-v-7185e49c data-v-7185e49c>split strategies</strong> to apply.
The method <code data-v-7185e49c data-v-7185e49c>chunk</code> gets a text as input and returns a list of chunks.</p>
<p data-v-7185e49c data-v-7185e49c>Below is an example of usage and chunks obtained with <code data-v-7185e49c data-v-7185e49c>chunkipy</code>.
Note that it is a basic usage example, with the default tokenizator and splitting strategies.
The generated chunks are below 50 tokens length, as <code data-v-7185e49c data-v-7185e49c>chunk_size</code> is set to 50, and they overlap for no more of 30% (being <code data-v-7185e49c data-v-7185e49c>overlap_percent</code> = 0.3).
It is computed on the <code data-v-7185e49c data-v-7185e49c>chunk_size</code> value, therefore the overlap size is about 16 tokens.</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-python" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c><span class="token keyword" data-v-7185e49c data-v-7185e49c>from</span> chunkipy <span class="token keyword" data-v-7185e49c data-v-7185e49c>import</span> TextChunker 
text_chunker <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> TextChunker<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token number" data-v-7185e49c data-v-7185e49c>50</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> tokens<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span><span class="token boolean" data-v-7185e49c data-v-7185e49c>True</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> overlap_percent<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span><span class="token number" data-v-7185e49c data-v-7185e49c>0.3</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>

<span class="token comment" data-v-7185e49c data-v-7185e49c># Set up test input</span>
text <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token string" data-v-7185e49c data-v-7185e49c>"In this unit test, we are evaluating the overlapping functionality."</span> \
       <span class="token string" data-v-7185e49c data-v-7185e49c>"This is a feature of the TextChunker class, which is important for a proper context keeping. The "</span> \
       <span class="token string" data-v-7185e49c data-v-7185e49c>"goal is to ensure that overlapping chunks are generated correctly. For this purpose, we have chosen a "</span> \
       <span class="token string" data-v-7185e49c data-v-7185e49c>"long text that exceeds 100 tokens. By setting the overlap_percent to 0.3, we expect the "</span> \
       <span class="token string" data-v-7185e49c data-v-7185e49c>"generated chunks to have an overlap of approximately 30%. This will help us verify the effectiveness "</span> \
       <span class="token string" data-v-7185e49c data-v-7185e49c>"of the overlapping feature. The TextChunker class should be able to handle this scenario and "</span> \
       <span class="token string" data-v-7185e49c data-v-7185e49c>"produce the expected results. Let's proceed with running the test and asserting the generated chunks "</span> \
       <span class="token string" data-v-7185e49c data-v-7185e49c>"for proper overlap. "</span>

<span class="token comment" data-v-7185e49c data-v-7185e49c># Generate chunks with overlapping</span>
chunks <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> text_chunker<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>chunk<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>

<span class="token comment" data-v-7185e49c data-v-7185e49c># Print the resulting chunks</span>
<span class="token keyword" data-v-7185e49c data-v-7185e49c>for</span> i<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> chunk <span class="token keyword" data-v-7185e49c data-v-7185e49c>in</span> <span class="token builtin" data-v-7185e49c data-v-7185e49c>enumerate</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>chunks<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
    <span class="token keyword" data-v-7185e49c data-v-7185e49c>print</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token string-interpolation" data-v-7185e49c data-v-7185e49c><span class="token string" data-v-7185e49c data-v-7185e49c>f"Chunk </span><span class="token interpolation" data-v-7185e49c data-v-7185e49c><span class="token punctuation" data-v-7185e49c data-v-7185e49c>{</span>i <span class="token operator" data-v-7185e49c data-v-7185e49c>+</span> <span class="token number" data-v-7185e49c data-v-7185e49c>1</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>}</span></span><span class="token string" data-v-7185e49c data-v-7185e49c>: </span><span class="token interpolation" data-v-7185e49c data-v-7185e49c><span class="token punctuation" data-v-7185e49c data-v-7185e49c>{</span>chunk<span class="token punctuation" data-v-7185e49c data-v-7185e49c>}</span></span><span class="token string" data-v-7185e49c data-v-7185e49c>"</span></span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
</code></pre></div>
<p data-v-7185e49c data-v-7185e49c>This outputs:</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-text" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>Chunk 1: In this unit test, we are evaluating the overlapping functionality. This is a feature of the TextChunker class, which is important for a proper context keeping. The goal is to ensure that overlapping chunks are generated correctly. For this purpose, we have chosen a long text that exceeds 100 tokens.
Chunk 2: For this purpose, we have chosen a long text that exceeds 100 tokens. By setting the overlap_percent to 0.3, we expect the generated chunks to have an overlap of approximately 30%. This will help us verify the effectiveness of the overlapping feature.
Chunk 3: This will help us verify the effectiveness of the overlapping feature. The TextChunker class should be able to handle this scenario and produce the expected results. Let's proceed with running the test and asserting the generated chunks for proper overlap.
</code></pre></div>
<br data-v-7185e49c data-v-7185e49c> 
<p data-v-7185e49c data-v-7185e49c>From the obtained chunks, it is evident that no sentence is cut in the half; overlap is kept under the threshold limit and applied only if possible.
Also, the heuristic implemented makes sure to put as much text as possible in each chunk in order to lower the number of chunks generated.
It is really important when one cares about the cost of handling an enormous number of chunks, like I did in several project.</p>
<h3 id="sentence-segmentation" data-v-7185e49c data-v-7185e49c><a href="#sentence-segmentation" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Sentence Segmentation</h3>
<p data-v-7185e49c data-v-7185e49c>At the core of this library lies the concept of <strong data-v-7185e49c data-v-7185e49c>sentence segmentation</strong>. By identifying natural sentence boundaries,
the library ensures that chunks are constructed based on linguistic structure, enhancing semantic coherence.</p>
<p data-v-7185e49c data-v-7185e49c>The code is a function named <code data-v-7185e49c data-v-7185e49c>split_by_sentences</code> that takes a text input and aims to split it into individual sentences
based on language detection using the <code data-v-7185e49c data-v-7185e49c>langdetect</code> library and sentence tokenization provided by the <code data-v-7185e49c data-v-7185e49c>stanza</code> library.
Here is the code:</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-python" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c><span class="token keyword" data-v-7185e49c data-v-7185e49c>import</span> stanza
<span class="token keyword" data-v-7185e49c data-v-7185e49c>from</span> stanza <span class="token keyword" data-v-7185e49c data-v-7185e49c>import</span> DownloadMethod
<span class="token keyword" data-v-7185e49c data-v-7185e49c>import</span> langdetect

<span class="token keyword" data-v-7185e49c data-v-7185e49c>def</span> <span class="token function" data-v-7185e49c data-v-7185e49c>split_by_sentences</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
    lang <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> langdetect<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>detect<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
    sentence_tokenizer <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> stanza<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>Pipeline<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>lang<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span>lang<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> processors<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span><span class="token string" data-v-7185e49c data-v-7185e49c>'tokenize'</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> download_method<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span>DownloadMethod<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>REUSE_RESOURCES<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
    <span class="token keyword" data-v-7185e49c data-v-7185e49c>return</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span>s<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>text <span class="token operator" data-v-7185e49c data-v-7185e49c>+</span> <span class="token string" data-v-7185e49c data-v-7185e49c>" "</span> <span class="token keyword" data-v-7185e49c data-v-7185e49c>for</span> s <span class="token keyword" data-v-7185e49c data-v-7185e49c>in</span> sentence_tokenizer<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>sentences<span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span>
</code></pre></div>
<p data-v-7185e49c data-v-7185e49c>It is a straightforward function; but let's give a look to this line, the most interesting:</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-python" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>sentence_tokenizer <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> stanza<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>Pipeline<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>lang<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span>lang<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> processors<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span><span class="token string" data-v-7185e49c data-v-7185e49c>'tokenize'</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> download_method<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span>DownloadMethod<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>REUSE_RESOURCES<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
</code></pre></div>
<p data-v-7185e49c data-v-7185e49c>This code initializes a stanza pipeline specific to the detected language (lang) and it is configured to tokenize
the text into sentences (processors='tokenize') using the specified language. The use of a language detector is
fundamental to correctly segment the text into sentences, respecting the peculiarities of the languages.<br data-v-7185e49c data-v-7185e49c>
The <code data-v-7185e49c data-v-7185e49c>DownloadMethod.REUSE_RESOURCES</code> ensures that previously downloaded resources are reused rather than redownloading them.</p>
<h3 id="other-splitting-strategies-and-recursive-adaptation" data-v-7185e49c data-v-7185e49c><a href="#other-splitting-strategies-and-recursive-adaptation" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Other Splitting Strategies and Recursive Adaptation</h3>
<p data-v-7185e49c data-v-7185e49c>Beyond <strong data-v-7185e49c data-v-7185e49c>sentence segmentation</strong>, the library offers alternative splitting strategies.
These strategies adapt recursively to the content's linguistic intricacies, ensuring the resulting chunks remain
semantically relevant regardless of the text's complexity.</p>
<p data-v-7185e49c data-v-7185e49c>By default, <code data-v-7185e49c data-v-7185e49c>chunkipy</code> uses <code data-v-7185e49c data-v-7185e49c>stanza</code> are main text splitting method; however, if <code data-v-7185e49c data-v-7185e49c>stanza</code> produces
sentences with a number of tokens greater than the chunk size, other split strategies are used.
Here the list of predefined strategies, sorted by priority (the first one is executed first,
if the chunk of text is larger than the chunk size, it is further split using a lower priority
strategy).</p>



































<table data-v-7185e49c data-v-7185e49c><thead data-v-7185e49c data-v-7185e49c><tr data-v-7185e49c data-v-7185e49c><th align="center" data-v-7185e49c data-v-7185e49c>Priority</th><th align="left" data-v-7185e49c data-v-7185e49c>Name</th><th align="left" data-v-7185e49c data-v-7185e49c>Effect</th></tr></thead><tbody data-v-7185e49c data-v-7185e49c><tr data-v-7185e49c data-v-7185e49c><td align="center" data-v-7185e49c data-v-7185e49c>0</td><td align="left" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>split_by_sentences</code></td><td align="left" data-v-7185e49c data-v-7185e49c>It uses <code data-v-7185e49c data-v-7185e49c>stanza</code> to split the text into meaningful sentences.</td></tr><tr data-v-7185e49c data-v-7185e49c><td align="center" data-v-7185e49c data-v-7185e49c>1</td><td align="left" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>split_by_semicolon</code></td><td align="left" data-v-7185e49c data-v-7185e49c>It splits the text using the semicolon and space <code data-v-7185e49c data-v-7185e49c>; </code>  as separator.</td></tr><tr data-v-7185e49c data-v-7185e49c><td align="center" data-v-7185e49c data-v-7185e49c>2</td><td align="left" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>split_by_colon</code></td><td align="left" data-v-7185e49c data-v-7185e49c>It splits the text using the colon and space <code data-v-7185e49c data-v-7185e49c>: </code> as separator.</td></tr><tr data-v-7185e49c data-v-7185e49c><td align="center" data-v-7185e49c data-v-7185e49c>3</td><td align="left" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>split_by_comma</code></td><td align="left" data-v-7185e49c data-v-7185e49c>It splits the text using the comma and space <code data-v-7185e49c data-v-7185e49c>, </code> as separator.</td></tr><tr data-v-7185e49c data-v-7185e49c><td align="center" data-v-7185e49c data-v-7185e49c>4</td><td align="left" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>split_by_word</code></td><td align="left" data-v-7185e49c data-v-7185e49c>It splits the text using the space <code data-v-7185e49c data-v-7185e49c> </code> as separator.</td></tr></tbody></table>
<br data-v-7185e49c data-v-7185e49c>
<p data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>Chunkipy</code> allows defining your own strategies, therefore you can design your custom chunkers, emphasizing and valuating
your business needs.</p>
<p data-v-7185e49c data-v-7185e49c>Here is an example on how one could define a different set of splitting strategies while creating the <code data-v-7185e49c data-v-7185e49c>TextChunker</code> class:</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-python" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c><span class="token keyword" data-v-7185e49c data-v-7185e49c>from</span> chunkipy <span class="token keyword" data-v-7185e49c data-v-7185e49c>import</span> TextChunker

<span class="token keyword" data-v-7185e49c data-v-7185e49c>def</span> <span class="token function" data-v-7185e49c data-v-7185e49c>split_by_arrow</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
    <span class="token keyword" data-v-7185e49c data-v-7185e49c>return</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span>t <span class="token keyword" data-v-7185e49c data-v-7185e49c>for</span> t <span class="token keyword" data-v-7185e49c data-v-7185e49c>in</span> text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>split<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token string" data-v-7185e49c data-v-7185e49c>"->"</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span> <span class="token keyword" data-v-7185e49c data-v-7185e49c>if</span> t <span class="token operator" data-v-7185e49c data-v-7185e49c>!=</span> <span class="token string" data-v-7185e49c data-v-7185e49c>''</span> <span class="token keyword" data-v-7185e49c data-v-7185e49c>and</span> <span class="token string" data-v-7185e49c data-v-7185e49c>' '</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span>

text <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token string" data-v-7185e49c data-v-7185e49c>"This is a tokenized text -> with custom split strategy."</span>

<span class="token comment" data-v-7185e49c data-v-7185e49c># Create a TextChunker object with custom split strategy</span>
text_chunker <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> TextChunker<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>chunk_size<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span><span class="token number" data-v-7185e49c data-v-7185e49c>8</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> tokens<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span><span class="token boolean" data-v-7185e49c data-v-7185e49c>True</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span>
                           split_strategies<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span>split_by_arrow<span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>  <span class="token comment" data-v-7185e49c data-v-7185e49c># you can define more</span>
<span class="token keyword" data-v-7185e49c data-v-7185e49c>print</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text_chunker<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>chunk<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
</code></pre></div>
<p data-v-7185e49c data-v-7185e49c>This outputs:</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-text" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>["This is a tokenized text", " with custom split strategy."]
</code></pre></div>
<h3 id="define-a-custom-tokenizer" data-v-7185e49c data-v-7185e49c><a href="#define-a-custom-tokenizer" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Define a custom tokenizer</h3>
<p data-v-7185e49c data-v-7185e49c>By default, the tokenization used is the space <code data-v-7185e49c data-v-7185e49c> </code> separator, to count the words in a sentence.
If you are working with neural network, it makes sense to define and use that tokenizer to count the tokens.
You can define a custom tokenizer counter function by inheriting from the <code data-v-7185e49c data-v-7185e49c>TokenEstimator</code> class and overriding the
<code data-v-7185e49c data-v-7185e49c>estimate_tokens</code> like shown in the example below, designed for the <code data-v-7185e49c data-v-7185e49c>tiktoken</code> tokenizer.</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-python" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c><span class="token keyword" data-v-7185e49c data-v-7185e49c>class</span> <span class="token class-name" data-v-7185e49c data-v-7185e49c>OpenAITokenEstimator</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>TokenEstimator<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>

    <span class="token keyword" data-v-7185e49c data-v-7185e49c>def</span> <span class="token function" data-v-7185e49c data-v-7185e49c>__init__</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> encoding_name<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
        self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>tokenizer <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> tiktoken<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>get_encoding<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>encoding_name<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>

    <span class="token keyword" data-v-7185e49c data-v-7185e49c>def</span> <span class="token function" data-v-7185e49c data-v-7185e49c>estimate_tokens</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
        <span class="token keyword" data-v-7185e49c data-v-7185e49c>return</span> <span class="token builtin" data-v-7185e49c data-v-7185e49c>len</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>tokenizer<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>encode<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
</code></pre></div>
<p data-v-7185e49c data-v-7185e49c>This class has to be passed as argument of the <code data-v-7185e49c data-v-7185e49c>TextChunker</code> constructor, as shown here:</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-python" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>text_chunker <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> TextChunker<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token number" data-v-7185e49c data-v-7185e49c>512</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> tokens<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span><span class="token boolean" data-v-7185e49c data-v-7185e49c>True</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> token_estimator<span class="token operator" data-v-7185e49c data-v-7185e49c>=</span>OpenAITokenEstimator<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
</code></pre></div>
<br data-v-7185e49c data-v-7185e49c>
<h3 id="chunks-building" data-v-7185e49c data-v-7185e49c><a href="#chunks-building" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Chunks Building</h3>
<p data-v-7185e49c data-v-7185e49c>The process of chunk building involves aggregating sentences with coherent meanings.
This approach allows for more contextually aware chunks, improving overall readability and understanding.</p>
<p data-v-7185e49c data-v-7185e49c>This function, named <code data-v-7185e49c data-v-7185e49c>_build_chunks</code>, takes in <code data-v-7185e49c data-v-7185e49c>text_parts_and_counts</code> as input: it is a list of tuples containing text
parts and their respective element counts. The function aims to construct chunks of text based on certain size constraints
(<code data-v-7185e49c data-v-7185e49c>chunk_size</code>). Let's give a look at the code:</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-python" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c><span class="token keyword" data-v-7185e49c data-v-7185e49c>def</span> <span class="token function" data-v-7185e49c data-v-7185e49c>_build_chunks</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> text_parts_and_counts<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
    chunks <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span>

    chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token number" data-v-7185e49c data-v-7185e49c>0</span>
    chunk <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span>

    <span class="token keyword" data-v-7185e49c data-v-7185e49c>for</span> text_part<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> element_count <span class="token keyword" data-v-7185e49c data-v-7185e49c>in</span> text_parts_and_counts<span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
        <span class="token keyword" data-v-7185e49c data-v-7185e49c>if</span> chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>+</span> element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>&lt;=</span> self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>chunk_size<span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
            <span class="token comment" data-v-7185e49c data-v-7185e49c># there is still space in the chunk, add the sentence and increase the counter</span>
            chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>+=</span> element_count
            chunk<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>append<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text_part<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
        <span class="token keyword" data-v-7185e49c data-v-7185e49c>else</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>  
            <span class="token comment" data-v-7185e49c data-v-7185e49c># there is not enough space for another sentence in the chunk. </span>
            <span class="token comment" data-v-7185e49c data-v-7185e49c># chunk is formed and added to the chunks array; the new sentence is added</span>
            <span class="token comment" data-v-7185e49c data-v-7185e49c># to the new chunk and the counter initialized again</span>
            chunks<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>append<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token string" data-v-7185e49c data-v-7185e49c>""</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>join<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>chunk<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>strip<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
            chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token number" data-v-7185e49c data-v-7185e49c>0</span>
            chunk <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span>
            
            chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>+=</span> element_count
            chunk <span class="token operator" data-v-7185e49c data-v-7185e49c>+=</span> text_part
            
    chunks<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>append<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token string" data-v-7185e49c data-v-7185e49c>""</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>join<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>chunk<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>strip<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
    <span class="token keyword" data-v-7185e49c data-v-7185e49c>return</span> chunks
</code></pre></div>
<p data-v-7185e49c data-v-7185e49c>Here's a breakdown of what the function does:</p>
<ol data-v-7185e49c data-v-7185e49c>
<li data-v-7185e49c data-v-7185e49c>
<p data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Initialization</strong>: Initializes various variables, i.e.:</p>
<ul data-v-7185e49c data-v-7185e49c>
<li data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>chunks</code>, an empty list to store generated chunks,</li>
<li data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>chunk_element_count</code>, tracks the number of elements in the current chunk,</li>
<li data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>chunk</code>, represents the current chunk being formed,</li>
</ul>
<br data-v-7185e49c data-v-7185e49c>
</li>
<li data-v-7185e49c data-v-7185e49c>
<p data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Iterating Through Input</strong>: It iterates through each tuple in <code data-v-7185e49c data-v-7185e49c>text_parts_and_counts</code>, which contains a text part and its associated count of elements.</p>
</li>
<li data-v-7185e49c data-v-7185e49c>
<p data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Chunk Formation</strong>:</p>
<ul data-v-7185e49c data-v-7185e49c>
<li data-v-7185e49c data-v-7185e49c>If adding the text from the current <code data-v-7185e49c data-v-7185e49c>text_part</code> to the existing chunk keeps the total element count within the specified <code data-v-7185e49c data-v-7185e49c>chunk_size</code>, it adds the <code data-v-7185e49c data-v-7185e49c>text_part</code> to the chunk.</li>
<li data-v-7185e49c data-v-7185e49c>If the addition of the current <code data-v-7185e49c data-v-7185e49c>text_part</code> causes the <code data-v-7185e49c data-v-7185e49c>chunk_element_count</code> to exceed <code data-v-7185e49c data-v-7185e49c>chunk_size</code>, it appends the constructed chunk (joining the text parts together) to the chunks list, resets the <code data-v-7185e49c data-v-7185e49c>chunk_element_count</code> and <code data-v-7185e49c data-v-7185e49c>chunk</code> variables, and continues forming new chunks.</li>
</ul>
<br data-v-7185e49c data-v-7185e49c>
</li>
<li data-v-7185e49c data-v-7185e49c>
<p data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Appending the Final Chunk</strong>: After the loop ends, it appends the remaining contents of the chunk (if any) to the chunks list.</p>
</li>
<li data-v-7185e49c data-v-7185e49c>
<p data-v-7185e49c data-v-7185e49c><strong data-v-7185e49c data-v-7185e49c>Return</strong>: Finally, it returns the list of constructed chunks.</p>
</li>
</ol>
<br data-v-7185e49c data-v-7185e49c> 
<h3 id="overlapping" data-v-7185e49c data-v-7185e49c><a href="#overlapping" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Overlapping</h3>
<p data-v-7185e49c data-v-7185e49c>To maintain context between adjacent chunks, a controlled overlapping technique is employed.
This ensures that critical information is not lost due to arbitrary segment boundaries.</p>
<p data-v-7185e49c data-v-7185e49c>The system aims to ensure that the last text parts of each segment do not exceed the maximum token limit defined for overlap.
For example, if the <code data-v-7185e49c data-v-7185e49c>chunk_size</code> is set to 100 and the <code data-v-7185e49c data-v-7185e49c>overlap_percentage</code> is 0.1, the maximum number of overlapping tokens is 10.
Consequently, if there are sentences or text parts that fit within this token limit, they are added at the beginning of the next segment.
If not, they are skipped to maintain a good ratio between overlap and content.</p>
<p data-v-7185e49c data-v-7185e49c>The code for overlapping is handled in the <code data-v-7185e49c data-v-7185e49c>_build_chunks</code> function, which is updated as follows:</p>
<div class="nuxt-content-highlight" data-v-7185e49c data-v-7185e49c><pre class="line-numbers language-python" data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c><span class="token keyword" data-v-7185e49c data-v-7185e49c>def</span> <span class="token function" data-v-7185e49c data-v-7185e49c>_build_chunks</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> text_parts_and_counts<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
    chunks <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span>

    chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token number" data-v-7185e49c data-v-7185e49c>0</span>
    chunk <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span>
    overlap_count <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token number" data-v-7185e49c data-v-7185e49c>0</span>         <span class="token comment" data-v-7185e49c data-v-7185e49c># keep track of how many tokens are in the overlapping section</span>
    overlapping <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> deque<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>     <span class="token comment" data-v-7185e49c data-v-7185e49c># keep track of the overlapping sentences</span>

    <span class="token keyword" data-v-7185e49c data-v-7185e49c>for</span> text_part<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> element_count <span class="token keyword" data-v-7185e49c data-v-7185e49c>in</span> text_parts_and_counts<span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
        <span class="token keyword" data-v-7185e49c data-v-7185e49c>if</span> chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>+</span> element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>&lt;=</span> self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>chunk_size<span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
            chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>+=</span> element_count
            chunk<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>append<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text_part<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
            <span class="token keyword" data-v-7185e49c data-v-7185e49c>if</span> self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>overlap_size <span class="token operator" data-v-7185e49c data-v-7185e49c>></span> <span class="token number" data-v-7185e49c data-v-7185e49c>0</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>  <span class="token comment" data-v-7185e49c data-v-7185e49c># this code is executed only if overlapping is enabled</span>
                <span class="token keyword" data-v-7185e49c data-v-7185e49c>while</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>overlap_count <span class="token operator" data-v-7185e49c data-v-7185e49c>+</span> element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>></span> self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>overlap_size<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span> <span class="token keyword" data-v-7185e49c data-v-7185e49c>and</span> overlapping<span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
                    <span class="token comment" data-v-7185e49c data-v-7185e49c># while overlapping deque is not empty and its total token count (including the new element)</span>
                    <span class="token comment" data-v-7185e49c data-v-7185e49c># is higher than the overlap_size, remove the first (i.e. the oldest) text part</span>
                    _<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> first_overlapping_count <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> overlapping<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>popleft<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
                    overlap_count <span class="token operator" data-v-7185e49c data-v-7185e49c>-=</span> first_overlapping_count
        <span class="token keyword" data-v-7185e49c data-v-7185e49c>else</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
            chunks<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>append<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token string" data-v-7185e49c data-v-7185e49c>""</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>join<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>chunk<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>strip<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
            chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token number" data-v-7185e49c data-v-7185e49c>0</span>
            chunk <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span>
            <span class="token keyword" data-v-7185e49c data-v-7185e49c>if</span> self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>overlap_size <span class="token operator" data-v-7185e49c data-v-7185e49c>></span> <span class="token number" data-v-7185e49c data-v-7185e49c>0</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>  <span class="token comment" data-v-7185e49c data-v-7185e49c># this code is executed only if overlapping is enabled</span>
                <span class="token comment" data-v-7185e49c data-v-7185e49c># add the overlapping text to next chunk and reset the counter taking into account the overlapping too</span>
                overlapping_text <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token string" data-v-7185e49c data-v-7185e49c>""</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>join<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span>t<span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span><span class="token number" data-v-7185e49c data-v-7185e49c>0</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span> <span class="token keyword" data-v-7185e49c data-v-7185e49c>for</span> t <span class="token keyword" data-v-7185e49c data-v-7185e49c>in</span> overlapping<span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
                chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> overlap_count
                chunk <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token punctuation" data-v-7185e49c data-v-7185e49c>[</span>overlapping_text<span class="token punctuation" data-v-7185e49c data-v-7185e49c>]</span>
                overlap_count <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> <span class="token number" data-v-7185e49c data-v-7185e49c>0</span>
                overlapping <span class="token operator" data-v-7185e49c data-v-7185e49c>=</span> deque<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>

            chunk_element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>+=</span> element_count
            chunk <span class="token operator" data-v-7185e49c data-v-7185e49c>+=</span> text_part

        <span class="token keyword" data-v-7185e49c data-v-7185e49c>if</span> element_count <span class="token operator" data-v-7185e49c data-v-7185e49c>&lt;=</span> self<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>overlap_size<span class="token punctuation" data-v-7185e49c data-v-7185e49c>:</span>
            <span class="token comment" data-v-7185e49c data-v-7185e49c># add the element to the overlapping deque, if its total token count is under the limit</span>
            overlap_count <span class="token operator" data-v-7185e49c data-v-7185e49c>+=</span> element_count
            overlapping<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>append<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>text_part<span class="token punctuation" data-v-7185e49c data-v-7185e49c>,</span> element_count<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>

    chunks<span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>append<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token string" data-v-7185e49c data-v-7185e49c>""</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>join<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span>chunk<span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>.</span>strip<span class="token punctuation" data-v-7185e49c data-v-7185e49c>(</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span><span class="token punctuation" data-v-7185e49c data-v-7185e49c>)</span>
    <span class="token keyword" data-v-7185e49c data-v-7185e49c>return</span> chunks
</code></pre></div>
<p data-v-7185e49c data-v-7185e49c>Two more variables are used and initialized:</p>
<ul data-v-7185e49c data-v-7185e49c>
<li data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>overlap_count</code>, keeps track of the count of overlapping elements,</li>
<li data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>overlapping</code>, a deque to manage overlapping text parts).</li>
</ul>
<br data-v-7185e49c data-v-7185e49c>
<p data-v-7185e49c data-v-7185e49c>It manages overlapping text parts based on the <code data-v-7185e49c data-v-7185e49c>overlap_size</code>.</p>
<p data-v-7185e49c data-v-7185e49c>When an <code data-v-7185e49c data-v-7185e49c>element_count</code> is less than or equal to the specified <code data-v-7185e49c data-v-7185e49c>overlap_size</code>, it keeps track of the overlapping elements
and manages the <code data-v-7185e49c data-v-7185e49c>overlap_count</code> accordingly.
Overlapping elements that exceed the <code data-v-7185e49c data-v-7185e49c>overlap_size</code> are removed from the beginning of the <code data-v-7185e49c data-v-7185e49c>overlapping</code> deque.
This is performed while iterating each tuple in <code data-v-7185e49c data-v-7185e49c>text_parts_and_counts</code> to keep the algorithm complexity linear with the input.</p>
<h2 id="comparison-with-other-libraries" data-v-7185e49c data-v-7185e49c><a href="#comparison-with-other-libraries" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Comparison with other libraries</h2>
<p data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>chunkipy</code> was built taking into consideration my own needs, not to compete with other libraries. However, the comparison comes out naturally,
to justify why to build a library from the scratch instead of using one already built.
Many chunking libraries exist and all of them have their pros and cons, and as a consequence, it is barely impossible to compare them each other.</p>
<p data-v-7185e49c data-v-7185e49c>Anyway, I would still mention <code data-v-7185e49c data-v-7185e49c>langchain</code>, which is widely used and often taken as reference for many engineers.</p>
<h3 id="langchain" data-v-7185e49c data-v-7185e49c><a href="#langchain" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>langchain</h3>
<p data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>langchain</code> is without any doubt a masterpiece. It is a solid library built by the NLP community to promote an easy
use of cutting-edge technologies, making them available and straightforward for everyone.
Being focused on NLP, one of its core feature is indeed <strong data-v-7185e49c data-v-7185e49c>text chunking</strong> or <strong data-v-7185e49c data-v-7185e49c>splitters</strong>.</p>
<p data-v-7185e49c data-v-7185e49c>Let's restrict our focus area on the text splitters that count tokens and that are compatible with OpenAI models,
which are they most used and relevant nowadays.
There are many text splitters based on token counting, complete list could be found at this
<a href="https://python.langchain.com/docs/modules/data_connection/document_transformers/text_splitters/split_by_token" rel="nofollow noopener noreferrer" target="_blank" data-v-7185e49c data-v-7185e49c>documentation page</a>.</p>
<p data-v-7185e49c data-v-7185e49c>Looking at that doc page, the logical choice would be the langchain's <code data-v-7185e49c data-v-7185e49c>CharacterTextSplitter.from_tiktoken_encoder</code>; but, as pointed out by the
documentation itself, it does not use any semantic feature to split the text and the <code data-v-7185e49c data-v-7185e49c>tiktoken</code> library tokenizer is only used to merge splits.
Going deeper in the code, it is clear that the separator used to split text is <code data-v-7185e49c data-v-7185e49c>\n\n</code>.
It means that split can be larger than chunk size measured by <code data-v-7185e49c data-v-7185e49c>tiktoken</code> tokenizer.</p>
<p data-v-7185e49c data-v-7185e49c>The more robust alternative suggested by Langchain is to use <code data-v-7185e49c data-v-7185e49c>RecursiveCharacterTextSplitter.from_tiktoken_encoder</code>
(<a href="https://python.langchain.com/docs/modules/data_connection/document_transformers/text_splitters/recursive_text_splitter" rel="nofollow noopener noreferrer" target="_blank" data-v-7185e49c data-v-7185e49c>documentation here</a>)
to make sure splits are not larger than chunk size of tokens allowed by the language model,
where each split will be recursively split if it has a larger size.</p>
<p data-v-7185e49c data-v-7185e49c>In fact, the <code data-v-7185e49c data-v-7185e49c>RecursiveCharacterTextSplitter</code>, like <code data-v-7185e49c data-v-7185e49c>chunkipy</code>, uses a recursive strategy to split text.
The default list of separators is <code data-v-7185e49c data-v-7185e49c>["\n\n", "\n", " ", ""]</code>.
This has the effect of trying to keep all paragraphs (and then sentences, and then words) together as long as possible,
as those would generically seem to be the strongest semantically related pieces of text.
Like <code data-v-7185e49c data-v-7185e49c>chunkipy</code>, you could define different splitting strategies or counting function,
though <code data-v-7185e49c data-v-7185e49c>RecursiveCharacterTextSplitter</code> only accepts character separators or regex, while
<code data-v-7185e49c data-v-7185e49c>chunkipy</code> allows using more sophisticated function to split the text.</p>
<h2 id="conclusions" data-v-7185e49c data-v-7185e49c><a href="#conclusions" aria-hidden="true" tabindex="-1" data-v-7185e49c data-v-7185e49c><span class="icon icon-link" data-v-7185e49c data-v-7185e49c></span></a>Conclusions</h2>
<p data-v-7185e49c data-v-7185e49c><code data-v-7185e49c data-v-7185e49c>chunkipy</code> is a hybrid-approach based chunker that capitalizes on sentence segmentation models for constructing text chunks of
superior quality. Compared to other libraries, it produces chunks that are not only more comprehensible but also improve the results
of downstream tasks, like vector search or named entity recognition.</p>
<p data-v-7185e49c data-v-7185e49c>Also, it is very flexible, allowing for custom text splitting strategies, including very complex pattern or custom heuristics.
Clearly, it is not perfect, and it could be optimized or improved with more features.</p>
<p data-v-7185e49c data-v-7185e49c>I was happy to learn that the library is widely used in my current company and in the previous one
by my colleagues, who appreciated the work done in this field. I hope this could help other people with similar needs.
If you want to contribute, if you find a bug or have a feature request,
please open an issue on <a href="https://github.com/gioelecrispo/chunkipy/issues" rel="nofollow noopener noreferrer" target="_blank" data-v-7185e49c data-v-7185e49c>GitHub</a>.</p></div></article></div></div> <div class="client-only-placeholder" data-v-7185e49c data-v-7185e49c>loading...</div></div></div></div></main> <footer id="footer" class="v-footer v-sheet theme--dark v-footer--padless sectionPrimary" data-v-1a526349 data-v-000c4056><svg viewBox="0 0 120 28" class="footer-svg" data-v-1a526349><defs data-v-1a526349><path id="wave" d="M 0,10 C 30,10 30,15 60,15 90,15 90,10 120,10 150,10 150,15 180,15 210,15 210,10 240,10 v 28 h -240 z" data-v-1a526349></path></defs> <use id="wave3" xlink:href="#wave" x="0" y="-2" class="wave" data-v-1a526349></use> <use id="wave2" xlink:href="#wave" x="0" y="0" class="wave" data-v-1a526349></use> <use id="wave1" xlink:href="#wave" x="0" y="1" class="wave" data-v-1a526349></use></svg> <div class="text-center footer-content v-card v-sheet theme--dark elevation-0 rounded-0" style="width:100%" data-v-1a526349><div class="container pa-2" data-v-1a526349><div class="row mx-2 align-center" data-v-1a526349><div class="col" data-v-1a526349><hr role="separator" aria-orientation="horizontal" class="v-divider theme--dark" data-v-1a526349></div> <div class="col" data-v-1a526349><span class="overline" style="font-size:16px!important" data-v-1a526349>Stay in touch</span></div> <div class="col" data-v-1a526349><hr role="separator" aria-orientation="horizontal" class="v-divider theme--dark" data-v-1a526349></div></div></div> <div class="v-card__text py-2" data-v-1a526349><div class="row align-center justify-center" data-v-1a526349><div class="pa-2 col-md-6 col-12" data-v-1a526349><div class="container pa-2" data-v-1a526349><div class="row mt-4 align-center justify-center" data-v-1a526349><h2 data-v-1a526349>Social</h2></div> <div class="row my-2 py-2 align-center justify-center" data-v-1a526349><div class="pa-0 col col-auto" data-v-1a526349><a href="https://github.com/gioelecrispo" target="_blank" class="mx-2 v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-1a526349><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-github theme--dark" style="font-size:24px" data-v-1a526349></i></span></a></div><div class="pa-0 col col-auto" data-v-1a526349><a href="https://www.linkedin.com/in/gioele-crispo/" target="_blank" class="mx-2 v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-1a526349><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-linkedin theme--dark" style="font-size:24px" data-v-1a526349></i></span></a></div><div class="pa-0 col col-auto" data-v-1a526349><a href="https://www.facebook.com/gioelecrispo" target="_blank" class="mx-2 v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-1a526349><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-facebook theme--dark" style="font-size:24px" data-v-1a526349></i></span></a></div><div class="pa-0 col col-auto" data-v-1a526349><a href="https://www.instagram.com/gioelecrispo" target="_blank" class="mx-2 v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-1a526349><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-instagram theme--dark" style="font-size:24px" data-v-1a526349></i></span></a></div><div class="pa-0 col col-auto" data-v-1a526349><a href="https://www.youtube.com/channel/UCX38YLmygw3cfwljiNlBBQw" target="_blank" class="mx-2 v-btn v-btn--icon v-btn--round theme--dark v-size--default" data-v-1a526349><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate mdi mdi-youtube theme--dark" style="font-size:24px" data-v-1a526349></i></span></a></div></div> <div class="row mt-4 pt-8 align-center justify-center" data-v-1a526349><h2 data-v-1a526349>Contacts</h2></div> <div class="row my-2 py-2 align-center justify-center" data-v-1a526349><i aria-hidden="true" class="v-icon notranslate ml-3 mr-1 mdi mdi-at theme--dark" data-v-1a526349></i> <span data-v-1a526349>crispogioele@gmail.com</span> <i aria-hidden="true" class="v-icon notranslate ml-3 mr-1 mdi mdi-skype theme--dark" data-v-1a526349></i> <span data-v-1a526349>gioele.crispo</span></div></div></div> <div class="pa-2 col-md-5 col-11" data-v-1a526349><div data-v-05974f4c data-v-1a526349><form novalidate class="v-form" data-v-05974f4c><div class="v-input v-input--dense theme--dark v-text-field v-text-field--filled v-text-field--enclosed v-text-field--outlined" data-v-05974f4c><div class="v-input__control"><div class="v-input__slot"><fieldset aria-hidden="true"><legend style="width:0"><span class="notranslate">​</span></legend></fieldset><div class="v-text-field__slot"><label for="input-1199" class="v-label theme--dark" style="left:0;right:auto;position:absolute">Name</label><input required id="input-1199"></div></div><div class="v-text-field__details"><div class="v-messages theme--dark"><div class="v-messages__wrapper"></div></div></div></div></div> <div class="v-input v-input--dense theme--dark v-text-field v-text-field--filled v-text-field--enclosed v-text-field--outlined" data-v-05974f4c><div class="v-input__control"><div class="v-input__slot"><fieldset aria-hidden="true"><legend style="width:0"><span class="notranslate">​</span></legend></fieldset><div class="v-text-field__slot"><label for="input-1202" class="v-label theme--dark" style="left:0;right:auto;position:absolute">Your E-mail</label><input required id="input-1202"></div></div><div class="v-text-field__details"><div class="v-messages theme--dark"><div class="v-messages__wrapper"></div></div></div></div></div> <div class="v-input v-textarea v-input--dense theme--dark v-text-field v-text-field--filled v-text-field--enclosed v-text-field--outlined" data-v-05974f4c><div class="v-input__control"><div class="v-input__slot"><fieldset aria-hidden="true"><legend style="width:0"><span class="notranslate">​</span></legend></fieldset><div class="v-text-field__slot"><label for="input-1205" class="v-label theme--dark" style="left:0;right:auto;position:absolute">Your message for me</label><textarea required id="input-1205" rows="5"></textarea></div></div><div class="v-text-field__details"><div class="v-messages theme--dark"><div class="v-messages__wrapper"></div></div></div></div></div> <button type="button" disabled class="mr-4 v-btn v-btn--disabled v-btn--has-bg v-btn--rounded theme--dark v-size--default" data-v-05974f4c><span class="v-btn__content">
            Send Message
        </span></button></form> <div class="v-dialog__container" data-v-05974f4c><!----></div></div></div></div></div> <div class="v-card__text pt-6 pb-4" data-v-1a526349><blockquote class="subheader pa-0" data-v-1a526349>
                You can not discover new oceans if you do not have the courage to
                lose sight of the shore.
            </blockquote></div> <hr role="separator" aria-orientation="horizontal" class="v-divider theme--dark" data-v-1a526349> <div class="v-card__text py-4" data-v-1a526349><div class="row" data-v-1a526349><div class="py-1 col-sm-6 col-12" data-v-1a526349>2024 — <span class="subtitle-1" data-v-1a526349>Gioele Crispo</span></div> <div class="py-1 col-sm-6 col-12" data-v-1a526349><span data-v-52319016 data-v-1a526349><a class="mx-2 mb-1 terms" data-v-52319016><span data-v-52319016>Terms and policy</span> <i aria-hidden="true" class="v-icon notranslate ml-3 mdi mdi-information-outline theme--dark" style="font-size:20px" data-v-52319016></i></a> <div class="v-dialog__container" data-v-52319016><!----></div></span></div></div></div></div></footer></div></div></div></div><script defer src="/_nuxt/static/1704239394/blog/the-importance-of-semantics-text-chunks-of-better-quality/state.js"></script><script src="/_nuxt/aa5daba.js" defer></script><script src="/_nuxt/fbbfe42.js" defer></script><script src="/_nuxt/01c6dd1.js" defer></script><script src="/_nuxt/9291ae6.js" defer></script><script src="/_nuxt/44fd46b.js" defer></script>
  </body>
</html>
